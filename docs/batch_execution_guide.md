# 퍼센티 배치 실행 가이드

## 개요

이 가이드는 퍼센티 자동화 시스템에서 배치 작업을 효율적으로 실행하는 방법을 설명합니다.

## 🚀 단기 해결책: 다중 프롬프트 배치 실행

### 1. 명령줄 배치 스크립트

#### 📁 `run_multi_batch.bat` - 대화형 다중 배치
```bash
# 실행 방법
./run_multi_batch.bat
```

**특징:**
- 단계, 수량, 계정을 대화형으로 입력
- 각 계정이 독립적인 콘솔 창에서 실행
- 브라우저 생성 간격 자동 조절 (5초)
- 실행 전 설정 확인

#### 📁 `run_quick_batch.bat` - 빠른 실행
```bash
# 실행 방법
./run_quick_batch.bat
```

**미리 설정된 옵션:**
1. 계정 1,2,3 - 단계1 - 수량5
2. 계정 1,2 - 단계1 - 수량3
3. 계정 1 - 단계1 - 수량10
4. 사용자 정의

### 2. GUI 다중 배치 실행기

#### 📁 `start_multi_batch_gui.bat` - GUI 실행기
```bash
# 실행 방법
./start_multi_batch_gui.bat
```

**특징:**
- 직관적인 GUI 인터페이스
- 실시간 프로세스 모니터링
- 각 계정별 독립적인 프로세스 실행
- 실행 간격 조절 가능
- 프로세스 상태 실시간 확인

## 🔧 중기 해결책: GUI 브라우저 생성 문제 해결

### 수정된 브라우저 관리자

`app/utils/browser_manager.py`가 다음과 같이 개선되었습니다:

#### 주요 개선사항:
1. **프로세스 분리**: `detach=True` 옵션으로 GUI 모드에서 안정성 향상
2. **타임아웃 적용**: 30초 타임아웃으로 브라우저 생성 실패 방지
3. **스레드 안전성**: `threading.Lock`으로 동시 생성 방지
4. **드라이버 상태 확인**: 기존 드라이버 재사용 전 상태 검증
5. **GUI 최적화 옵션**: Windows GUI 환경에 특화된 Chrome 옵션

#### 새로운 Chrome 옵션:
```python
# GUI 모드 최적화 옵션
chrome_options.add_argument("--no-first-run")
chrome_options.add_argument("--disable-blink-features=AutomationControlled")
chrome_options.add_experimental_option("detach", True)  # 프로세스 분리
chrome_options.add_argument("--disable-web-security")
chrome_options.add_argument("--allow-running-insecure-content")
```

## 📋 사용 방법

### 1. 명령줄 배치 실행

#### 기본 사용법:
```bash
# 대화형 실행
./run_multi_batch.bat

# 빠른 실행
./run_quick_batch.bat
```

#### 직접 CLI 사용:
```bash
# 단일 계정 실행
python cli/batch_cli.py single --step 1 --accounts 1 --quantity 5

# 여러 계정 순차 실행 (권장하지 않음)
python cli/batch_cli.py single --step 1 --accounts 1 2 3 --quantity 5
```

### 2. GUI 다중 배치 실행

1. `start_multi_batch_gui.bat` 실행
2. 설정 입력:
   - **단계**: 1-6 중 선택
   - **수량**: 실행할 작업 수량
   - **계정들**: 공백으로 구분 (예: `1 2 3`)
   - **실행 간격**: 각 계정 실행 사이의 대기 시간 (초)
3. "다중 배치 시작" 클릭
4. 각 계정이 독립적인 콘솔 창에서 실행됨
5. GUI에서 실시간 상태 모니터링

## ⚠️ 주의사항

### 동시 실행 제한
- **단일 프롬프트 내 동시 실행은 피하세요**
- 각 계정은 독립적인 프로세스에서 실행하는 것이 안전합니다
- 브라우저 생성 간격을 3-5초 이상 유지하세요

### 시스템 요구사항
- Chrome 브라우저 설치 필수
- 충분한 메모리 (계정당 약 500MB)
- 안정적인 인터넷 연결

### 문제 해결

#### 브라우저 생성 실패
1. Chrome 브라우저 설치 확인
2. 방화벽/보안 프로그램 확인
3. 관리자 권한으로 실행
4. 인터넷 연결 확인

#### 좌표 클릭 실패
1. 화면 해상도 확인 (1920x1080 권장)
2. 브라우저 창 겹침 방지
3. 다른 프로그램의 화면 간섭 확인

## 📊 성능 최적화

### 권장 설정
- **계정 수**: 3개 이하 동시 실행
- **실행 간격**: 5초 이상
- **수량**: 계정당 10개 이하

### 시스템 모니터링
- CPU 사용률 70% 이하 유지
- 메모리 사용률 80% 이하 유지
- 각 브라우저 프로세스 상태 확인

## 🔮 향후 개선 계획

### 장기 해결책 (추후 구현)
1. **멀티프로세싱 아키텍처**: 완전한 프로세스 격리
2. **DOM 기반 자동화**: 좌표 의존성 제거
3. **브라우저 풀 관리**: 효율적인 리소스 관리
4. **헤드리스 모드 최적화**: 성능 향상

## 📞 지원

문제가 발생하면 다음을 확인하세요:
1. 로그 파일 (`logs/` 디렉토리)
2. 콘솔 출력 메시지
3. 브라우저 프로세스 상태

---

**마지막 업데이트**: 2024년 12월
**버전**: 1.0.0